/*! For license information please see Idw2Contour-utils.js.LICENSE.txt */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.Idw2ContourUtils=n():t.Idw2ContourUtils=n()}(self,(function(){return(()=>{var t={970:function(t,n){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}var r;r=function(t){function n(t,n,e){this.obj=t,this.left=null,this.right=null,this.parent=e,this.dimension=n}function e(t){this.content=[],this.scoreFunction=t}e.prototype={push:function(t){this.content.push(t),this.bubbleUp(this.content.length-1)},pop:function(){var t=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.sinkDown(0)),t},peek:function(){return this.content[0]},remove:function(t){for(var n=this.content.length,e=0;e<n;e++)if(this.content[e]==t){var r=this.content.pop();return void(e!=n-1&&(this.content[e]=r,this.scoreFunction(r)<this.scoreFunction(t)?this.bubbleUp(e):this.sinkDown(e)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(t){for(var n=this.content[t];t>0;){var e=Math.floor((t+1)/2)-1,r=this.content[e];if(!(this.scoreFunction(n)<this.scoreFunction(r)))break;this.content[e]=n,this.content[t]=r,t=e}},sinkDown:function(t){for(var n=this.content.length,e=this.content[t],r=this.scoreFunction(e);;){var i=2*(t+1),o=i-1,s=null;if(o<n){var u=this.content[o],l=this.scoreFunction(u);l<r&&(s=o)}if(i<n){var h=this.content[i];this.scoreFunction(h)<(null==s?r:l)&&(s=i)}if(null==s)break;this.content[t]=this.content[s],this.content[s]=e,t=s}}},t.kdTree=function(t,r,i){var o,s=this;Array.isArray(t)?this.root=function t(e,r,o){var s,u,l=r%i.length;return 0===e.length?null:1===e.length?new n(e[0],l,o):(e.sort((function(t,n){return t[i[l]]-n[i[l]]})),(u=new n(e[s=Math.floor(e.length/2)],l,o)).left=t(e.slice(0,s),r+1,u),u.right=t(e.slice(s+1),r+1,u),u)}(t,0,null):(o=t,s.root=o,function t(n){n.left&&(n.left.parent=n,t(n.left)),n.right&&(n.right.parent=n,t(n.right))}(s.root)),this.toJSON=function(t){t||(t=this.root);var e=new n(t.obj,t.dimension,null);return t.left&&(e.left=s.toJSON(t.left)),t.right&&(e.right=s.toJSON(t.right)),e},this.insert=function(t){var e,r,o=function n(e,r){if(null===e)return r;var o=i[e.dimension];return t[o]<e.obj[o]?n(e.left,e):n(e.right,e)}(this.root,null);null!==o?(e=new n(t,(o.dimension+1)%i.length,o),r=i[o.dimension],t[r]<o.obj[r]?o.left=e:o.right=e):this.root=new n(t,0,null)},this.remove=function(t){var n;null!==(n=function n(e){if(null===e)return null;if(e.obj===t)return e;var r=i[e.dimension];return t[r]<e.obj[r]?n(e.left):n(e.right)}(s.root))&&function t(n){var e,r,o;function u(t,n){var e,r,o,s,l;return null===t?null:(e=i[n],t.dimension===n?null!==t.left?u(t.left,n):t:(r=t.obj[e],o=u(t.left,n),s=u(t.right,n),l=t,null!==o&&o.obj[e]<r&&(l=o),null!==s&&s.obj[e]<l.obj[e]&&(l=s),l))}if(null===n.left&&null===n.right)return null===n.parent?void(s.root=null):(o=i[n.parent.dimension],void(n.obj[o]<n.parent.obj[o]?n.parent.left=null:n.parent.right=null));null!==n.right?(r=(e=u(n.right,n.dimension)).obj,t(e),n.obj=r):(r=(e=u(n.left,n.dimension)).obj,t(e),n.right=n.left,n.left=null,n.obj=r)}(n)},this.nearest=function(t,n,o){var u,l,h;if(h=new e((function(t){return-t[1]})),o)for(u=0;u<n;u+=1)h.push([null,o]);for(s.root&&function e(o){var s,u,l,a,f=i[o.dimension],c=r(t,o.obj),p={};function g(t,e){h.push([t,e]),h.size()>n&&h.pop()}for(a=0;a<i.length;a+=1)a===o.dimension?p[i[a]]=t[i[a]]:p[i[a]]=o.obj[i[a]];u=r(p,o.obj),null!==o.right||null!==o.left?(e(s=null===o.right?o.left:null===o.left?o.right:t[f]<o.obj[f]?o.left:o.right),(h.size()<n||c<h.peek()[1])&&g(o,c),(h.size()<n||Math.abs(u)<h.peek()[1])&&null!==(l=s===o.left?o.right:o.left)&&e(l)):(h.size()<n||c<h.peek()[1])&&g(o,c)}(s.root),l=[],u=0;u<Math.min(n,h.content.length);u+=1)h.content[u][0]&&l.push([h.content[u][0].obj,h.content[u][1]]);return l},this.balanceFactor=function(){return function t(n){return null===n?0:Math.max(t(n.left),t(n.right))+1}(s.root)/(Math.log(function t(n){return null===n?0:t(n.left)+t(n.right)+1}(s.root))/Math.log(2))}},t.BinaryHeap=e},"object"===e(n)?r(n):r(this)},676:function(t){t.exports=function(){"use strict";function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function n(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function e(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}var r=function(t,n){this.next=null,this.key=t,this.data=n,this.left=null,this.right=null};function i(t,n){return t>n?1:t<n?-1:0}function o(t,n,e){for(var i=new r(null,null),o=i,s=i;;){var u=e(t,n.key);if(u<0){if(null===n.left)break;if(e(t,n.left.key)<0){var l=n.left;if(n.left=l.right,l.right=n,null===(n=l).left)break}s.left=n,s=n,n=n.left}else{if(!(u>0))break;if(null===n.right)break;if(e(t,n.right.key)>0&&(l=n.right,n.right=l.left,l.left=n,null===(n=l).right))break;o.right=n,o=n,n=n.right}}return o.right=n.left,s.left=n.right,n.left=i.right,n.right=i.left,n}function s(t,n,e,i){var s=new r(t,n);if(null===e)return s.left=s.right=null,s;var u=i(t,(e=o(t,e,i)).key);return u<0?(s.left=e.left,s.right=e,e.left=null):u>=0&&(s.right=e.right,s.left=e,e.right=null),s}function u(t,n,e){var r=null,i=null;if(n){var s=e((n=o(t,n,e)).key,t);0===s?(r=n.left,i=n.right):s<0?(i=n.right,n.right=null,r=n):(r=n.left,n.left=null,i=n)}return{left:r,right:i}}function l(t,n,e,r,i){if(t){r(n+(e?"└── ":"├── ")+i(t)+"\n");var o=n+(e?"    ":"│   ");t.left&&l(t.left,o,!1,r,i),t.right&&l(t.right,o,!0,r,i)}}var h=function(){function t(t){void 0===t&&(t=i),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,n){return this._size++,this._root=s(t,n,this._root,this._comparator)},t.prototype.add=function(t,n){var e=new r(t,n);null===this._root&&(e.left=e.right=null,this._size++,this._root=e);var i=this._comparator,s=o(t,this._root,i),u=i(t,s.key);return 0===u?this._root=s:(u<0?(e.left=s.left,e.right=s,s.left=null):u>0&&(e.right=s.right,e.left=s,s.right=null),this._size++,this._root=e),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,n,e){var r;return null===n?null:0===e(t,(n=o(t,n,e)).key)?(null===n.left?r=n.right:(r=o(t,n.left,e)).right=n.right,this._size--,r):n},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=o(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var n=this._root,e=this._comparator;n;){var r=e(t,n.key);if(0===r)return n;n=r<0?n.left:n.right}return null},t.prototype.find=function(t){return this._root&&(this._root=o(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var n=this._root,e=this._comparator;n;){var r=e(t,n.key);if(0===r)return!0;n=r<0?n.left:n.right}return!1},t.prototype.forEach=function(t,n){for(var e=this._root,r=[],i=!1;!i;)null!==e?(r.push(e),e=e.left):0!==r.length?(e=r.pop(),t.call(n,e),e=e.right):i=!0;return this},t.prototype.range=function(t,n,e,r){for(var i=[],o=this._comparator,s=this._root;0!==i.length||s;)if(s)i.push(s),s=s.left;else{if(o((s=i.pop()).key,n)>0)break;if(o(s.key,t)>=0&&e.call(r,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(n){var e=n.key;return t.push(e)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(n){var e=n.data;return t.push(e)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var n=this._root,e=!1,r=0,i=[];!e;)if(n)i.push(n),n=n.left;else if(i.length>0){if(n=i.pop(),r===t)return n;r++,n=n.right}else e=!0;return null},t.prototype.next=function(t){var n=this._root,e=null;if(t.right){for(e=t.right;e.left;)e=e.left;return e}for(var r=this._comparator;n;){var i=r(t.key,n.key);if(0===i)break;i<0?(e=n,n=n.left):n=n.right}return e},t.prototype.prev=function(t){var n=this._root,e=null;if(null!==t.left){for(e=t.left;e.right;)e=e.right;return e}for(var r=this._comparator;n;){var i=r(t.key,n.key);if(0===i)break;i<0?n=n.left:(e=n,n=n.right)}return e},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){for(var n=t,e=[],i=!1,o=new r(null,null),s=o;!i;)n?(e.push(n),n=n.left):e.length>0?n=(n=s=s.next=e.pop()).right:i=!0;return s.next=null,o.next}(this._root)},t.prototype.load=function(t,n,e){void 0===n&&(n=[]),void 0===e&&(e=!1);var i=t.length,o=this._comparator;if(e&&c(t,n,0,i-1,o),null===this._root)this._root=a(t,n,0,i),this._size=i;else{var s=function(t,n,e){for(var i=new r(null,null),o=i,s=t,u=n;null!==s&&null!==u;)e(s.key,u.key)<0?(o.next=s,s=s.next):(o.next=u,u=u.next),o=o.next;return null!==s?o.next=s:null!==u&&(o.next=u),i.next}(this.toList(),function(t,n){for(var e=new r(null,null),i=e,o=0;o<t.length;o++)i=i.next=new r(t[o],n[o]);return i.next=null,e.next}(t,n),o);i=this._size+i,this._root=f({head:s},0,i)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var n=[];return l(this._root,"",!0,(function(t){return n.push(t)}),t),n.join("")},t.prototype.update=function(t,n,e){var r=this._comparator,i=u(t,this._root,r),l=i.left,h=i.right;r(t,n)<0?h=s(n,e,h,r):l=s(n,e,l,r),this._root=function(t,n,e){return null===n?t:(null===t||((n=o(t.key,n,e)).left=t),n)}(l,h,r)},t.prototype.split=function(t){return u(t,this._root,this._comparator)},t}();function a(t,n,e,i){var o=i-e;if(o>0){var s=e+Math.floor(o/2),u=t[s],l=n[s],h=new r(u,l);return h.left=a(t,n,e,s),h.right=a(t,n,s+1,i),h}return null}function f(t,n,e){var r=e-n;if(r>0){var i=n+Math.floor(r/2),o=f(t,n,i),s=t.head;return s.left=o,t.head=t.head.next,s.right=f(t,i+1,e),s}return null}function c(t,n,e,r,i){if(!(e>=r)){for(var o=t[e+r>>1],s=e-1,u=r+1;;){do{s++}while(i(t[s],o)<0);do{u--}while(i(t[u],o)>0);if(s>=u)break;var l=t[s];t[s]=t[u],t[u]=l,l=n[s],n[s]=n[u],n[u]=l}c(t,n,e,u,i),c(t,n,u+1,r,i)}}var p=function(t,n){return t.ll.x<=n.x&&n.x<=t.ur.x&&t.ll.y<=n.y&&n.y<=t.ur.y},g=function(t,n){if(n.ur.x<t.ll.x||t.ur.x<n.ll.x||n.ur.y<t.ll.y||t.ur.y<n.ll.y)return null;var e=t.ll.x<n.ll.x?n.ll.x:t.ll.x,r=t.ur.x<n.ur.x?t.ur.x:n.ur.x;return{ll:{x:e,y:t.ll.y<n.ll.y?n.ll.y:t.ll.y},ur:{x:r,y:t.ur.y<n.ur.y?t.ur.y:n.ur.y}}},v=Number.EPSILON;void 0===v&&(v=Math.pow(2,-52));var y=v*v,x=function(t,n){if(-v<t&&t<v&&-v<n&&n<v)return 0;var e=t-n;return e*e<y*t*n?0:t<n?-1:1},d=function(){function n(){t(this,n),this.reset()}return e(n,[{key:"reset",value:function(){this.xRounder=new b,this.yRounder=new b}},{key:"round",value:function(t,n){return{x:this.xRounder.round(t),y:this.yRounder.round(n)}}}]),n}(),b=function(){function n(){t(this,n),this.tree=new h,this.round(0)}return e(n,[{key:"round",value:function(t){var n=this.tree.add(t),e=this.tree.prev(n);if(null!==e&&0===x(n.key,e.key))return this.tree.remove(t),e.key;var r=this.tree.next(n);return null!==r&&0===x(n.key,r.key)?(this.tree.remove(t),r.key):t}}]),n}(),m=new d,E=function(t,n){return t.x*n.y-t.y*n.x},S=function(t,n){return t.x*n.x+t.y*n.y},w=function(t,n,e){var r={x:n.x-t.x,y:n.y-t.y},i={x:e.x-t.x,y:e.y-t.y},o=E(r,i);return x(o,0)},_=function(t){return Math.sqrt(S(t,t))},k=function(t,n,e){var r={x:n.x-t.x,y:n.y-t.y},i={x:e.x-t.x,y:e.y-t.y};return S(i,r)/_(i)/_(r)},P=function(t,n,e){return 0===n.y?null:{x:t.x+n.x/n.y*(e-t.y),y:e}},M=function(t,n,e){return 0===n.x?null:{x:e,y:t.y+n.y/n.x*(e-t.x)}},R=function(){function n(e,r){t(this,n),void 0===e.events?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=r}return e(n,null,[{key:"compare",value:function(t,e){var r=n.comparePoints(t.point,e.point);return 0!==r?r:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft?t.isLeft?1:-1:j.compare(t.segment,e.segment))}},{key:"comparePoints",value:function(t,n){return t.x<n.x?-1:t.x>n.x?1:t.y<n.y?-1:t.y>n.y?1:0}}]),e(n,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var n=t.point.events,e=0,r=n.length;e<r;e++){var i=n[e];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,n=0;n<t;n++){var e=this.point.events[n];if(void 0===e.segment.consumedBy)for(var r=n+1;r<t;r++){var i=this.point.events[r];void 0===i.consumedBy&&e.otherSE.point.events===i.otherSE.point.events&&e.segment.consume(i.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],n=0,e=this.point.events.length;n<e;n++){var r=this.point.events[n];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&t.push(r)}return t}},{key:"getLeftmostComparator",value:function(t){var n=this,e=new Map,r=function(r){var i,o,s,u,l,h=r.otherSE;e.set(r,{sine:(i=n.point,o=t.point,s=h.point,u={x:o.x-i.x,y:o.y-i.y},l={x:s.x-i.x,y:s.y-i.y},E(l,u)/_(l)/_(u)),cosine:k(n.point,t.point,h.point)})};return function(t,n){e.has(t)||r(t),e.has(n)||r(n);var i=e.get(t),o=i.sine,s=i.cosine,u=e.get(n),l=u.sine,h=u.cosine;return o>=0&&l>=0?s<h?1:s>h?-1:0:o<0&&l<0?s<h?-1:s>h?1:0:l<o?-1:l>o?1:0}}}]),n}(),I=0,j=function(){function n(e,r,i,o){t(this,n),this.id=++I,this.leftSE=e,e.segment=this,e.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=e,this.rings=i,this.windings=o}return e(n,null,[{key:"compare",value:function(t,n){var e=t.leftSE.point.x,r=n.leftSE.point.x,i=t.rightSE.point.x,o=n.rightSE.point.x;if(o<e)return 1;if(i<r)return-1;var s=t.leftSE.point.y,u=n.leftSE.point.y,l=t.rightSE.point.y,h=n.rightSE.point.y;if(e<r){if(u<s&&u<l)return 1;if(u>s&&u>l)return-1;var a=t.comparePoint(n.leftSE.point);if(a<0)return 1;if(a>0)return-1;var f=n.comparePoint(t.rightSE.point);return 0!==f?f:-1}if(e>r){if(s<u&&s<h)return-1;if(s>u&&s>h)return 1;var c=n.comparePoint(t.leftSE.point);if(0!==c)return c;var p=t.comparePoint(n.rightSE.point);return p<0?1:p>0?-1:1}if(s<u)return-1;if(s>u)return 1;if(i<o){var g=n.comparePoint(t.rightSE.point);if(0!==g)return g}if(i>o){var v=t.comparePoint(n.rightSE.point);if(v<0)return 1;if(v>0)return-1}if(i!==o){var y=l-s,x=i-e,d=h-u,b=o-r;if(y>x&&d<b)return 1;if(y<x&&d>b)return-1}return i>o?1:i<o||l<h?-1:l>h?1:t.id<n.id?-1:t.id>n.id?1:0}}]),e(n,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<n?t:n},ur:{x:this.rightSE.point.x,y:t>n?t:n}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var n=this.leftSE.point,e=this.rightSE.point,r=this.vector();if(n.x===e.x)return t.x===n.x?0:t.x<n.x?1:-1;var i=(t.y-n.y)/r.y,o=n.x+i*r.x;if(t.x===o)return 0;var s=(t.x-n.x)/r.x,u=n.y+s*r.y;return t.y===u?0:t.y<u?-1:1}},{key:"getIntersection",value:function(t){var n=this.bbox(),e=t.bbox(),r=g(n,e);if(null===r)return null;var i=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,u=t.rightSE.point,l=p(n,s)&&0===this.comparePoint(s),h=p(e,i)&&0===t.comparePoint(i),a=p(n,u)&&0===this.comparePoint(u),f=p(e,o)&&0===t.comparePoint(o);if(h&&l)return f&&!a?o:!f&&a?u:null;if(h)return a&&i.x===u.x&&i.y===u.y?null:i;if(l)return f&&o.x===s.x&&o.y===s.y?null:s;if(f&&a)return null;if(f)return o;if(a)return u;var c=function(t,n,e,r){if(0===n.x)return M(e,r,t.x);if(0===r.x)return M(t,n,e.x);if(0===n.y)return P(e,r,t.y);if(0===r.y)return P(t,n,e.y);var i=E(n,r);if(0==i)return null;var o={x:e.x-t.x,y:e.y-t.y},s=E(o,n)/i,u=E(o,r)/i;return{x:(t.x+u*n.x+(e.x+s*r.x))/2,y:(t.y+u*n.y+(e.y+s*r.y))/2}}(i,this.vector(),s,t.vector());return null===c?null:p(r,c)?m.round(c.x,c.y):null}},{key:"split",value:function(t){var e=[],r=void 0!==t.events,i=new R(t,!0),o=new R(t,!1),s=this.rightSE;this.replaceRightSE(o),e.push(o),e.push(i);var u=new n(i,s,this.rings.slice(),this.windings.slice());return R.comparePoints(u.leftSE.point,u.rightSE.point)>0&&u.swapEvents(),R.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),o.checkForConsuming()),e}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var n=0,e=this.windings.length;n<e;n++)this.windings[n]*=-1}},{key:"consume",value:function(t){for(var e=this,r=t;e.consumedBy;)e=e.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var i=n.compare(e,r);if(0!==i){if(i>0){var o=e;e=r,r=o}if(e.prev===r){var s=e;e=r,r=s}for(var u=0,l=r.rings.length;u<l;u++){var h=r.rings[u],a=r.windings[u],f=e.rings.indexOf(h);-1===f?(e.rings.push(h),e.windings.push(a)):e.windings[f]+=a}r.rings=null,r.windings=null,r.consumedBy=e,r.leftSE.consumedBy=e.leftSE,r.rightSE.consumedBy=e.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var n=this._afterState.rings,e=this._afterState.windings,r=this._afterState.multiPolys,i=0,o=this.rings.length;i<o;i++){var s=this.rings[i],u=this.windings[i],l=n.indexOf(s);-1===l?(n.push(s),e.push(u)):e[l]+=u}for(var h=[],a=[],f=0,c=n.length;f<c;f++)if(0!==e[f]){var p=n[f],g=p.poly;if(-1===a.indexOf(g))if(p.isExterior)h.push(g);else{-1===a.indexOf(g)&&a.push(g);var v=h.indexOf(p.poly);-1!==v&&h.splice(v,1)}}for(var y=0,x=h.length;y<x;y++){var d=h[y].multiPoly;-1===r.indexOf(d)&&r.push(d)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(G.type){case"union":var e=0===t.length,r=0===n.length;this._isInResult=e!==r;break;case"intersection":var i,o;t.length<n.length?(i=t.length,o=n.length):(i=n.length,o=t.length),this._isInResult=o===G.numMultiPolys&&i<o;break;case"xor":var s=Math.abs(t.length-n.length);this._isInResult=s%2==1;break;case"difference":var u=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=u(t)!==u(n);break;default:throw new Error("Unrecognized operation type found ".concat(G.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,e,r){var i,o,s,u=R.comparePoints(t,e);if(u<0)i=t,o=e,s=1;else{if(!(u>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));i=e,o=t,s=-1}return new n(new R(i,!0),new R(o,!1),[r],[s])}}]),n}(),A=function(){function n(e,r,i){if(t(this,n),!Array.isArray(e)||0===e.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=r,this.isExterior=i,this.segments=[],"number"!=typeof e[0][0]||"number"!=typeof e[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var o=m.round(e[0][0],e[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};for(var s=o,u=1,l=e.length;u<l;u++){if("number"!=typeof e[u][0]||"number"!=typeof e[u][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var h=m.round(e[u][0],e[u][1]);h.x===s.x&&h.y===s.y||(this.segments.push(j.fromRing(s,h,this)),h.x<this.bbox.ll.x&&(this.bbox.ll.x=h.x),h.y<this.bbox.ll.y&&(this.bbox.ll.y=h.y),h.x>this.bbox.ur.x&&(this.bbox.ur.x=h.x),h.y>this.bbox.ur.y&&(this.bbox.ur.y=h.y),s=h)}o.x===s.x&&o.y===s.y||this.segments.push(j.fromRing(s,o,this))}return e(n,[{key:"getSweepEvents",value:function(){for(var t=[],n=0,e=this.segments.length;n<e;n++){var r=this.segments[n];t.push(r.leftSE),t.push(r.rightSE)}return t}}]),n}(),O=function(){function n(e,r){if(t(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new A(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var i=1,o=e.length;i<o;i++){var s=new A(e[i],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=r}return e(n,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),n=0,e=this.interiorRings.length;n<e;n++)for(var r=this.interiorRings[n].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),n}(),N=function(){function n(e,r){if(t(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof e[0][0][0]&&(e=[e])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var i=0,o=e.length;i<o;i++){var s=new O(e[i],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=r}return e(n,[{key:"getSweepEvents",value:function(){for(var t=[],n=0,e=this.polys.length;n<e;n++)for(var r=this.polys[n].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),n}(),z=function(){function n(e){t(this,n),this.events=e;for(var r=0,i=e.length;r<i;r++)e[r].segment.ringOut=this;this.poly=null}return e(n,null,[{key:"factory",value:function(t){for(var e=[],r=0,i=t.length;r<i;r++){var o=t[r];if(o.isInResult()&&!o.ringOut){for(var s=null,u=o.leftSE,l=o.rightSE,h=[u],a=u.point,f=[];s=u,u=l,h.push(u),u.point!==a;)for(;;){var c=u.getAvailableLinkedEvents();if(0===c.length){var p=h[0].point,g=h[h.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(p.x,",")+" ".concat(p.y,"]. Last matching segment found ends at")+" [".concat(g.x,", ").concat(g.y,"]."))}if(1===c.length){l=c[0].otherSE;break}for(var v=null,y=0,x=f.length;y<x;y++)if(f[y].point===u.point){v=y;break}if(null===v){f.push({index:h.length,point:u.point});var d=u.getLeftmostComparator(s);l=c.sort(d)[0].otherSE;break}var b=f.splice(v)[0],m=h.splice(b.index);m.unshift(m[0].otherSE),e.push(new n(m.reverse()))}e.push(new n(h))}}return e}}]),e(n,[{key:"getGeom",value:function(){for(var t=this.events[0].point,n=[t],e=1,r=this.events.length-1;e<r;e++){var i=this.events[e].point,o=this.events[e+1].point;0!==w(i,t,o)&&(n.push(i),t=i)}if(1===n.length)return null;var s=n[0],u=n[1];0===w(s,t,u)&&n.shift(),n.push(n[0]);for(var l=this.isExteriorRing()?1:-1,h=this.isExteriorRing()?0:n.length-1,a=this.isExteriorRing()?n.length:-1,f=[],c=h;c!=a;c+=l)f.push([n[c].x,n[c].y]);return f}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],n=1,e=this.events.length;n<e;n++){var r=this.events[n];R.compare(t,r)>0&&(t=r)}for(var i=t.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();i=o.prevInResult(),o=i?i.prevInResult():null}}}]),n}(),L=function(){function n(e){t(this,n),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return e(n,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var n=0,e=this.interiorRings.length;n<e;n++){var r=this.interiorRings[n].getGeom();null!==r&&t.push(r)}return t}}]),n}(),F=function(){function n(e){t(this,n),this.rings=e,this.polys=this._composePolys(e)}return e(n,[{key:"getGeom",value:function(){for(var t=[],n=0,e=this.polys.length;n<e;n++){var r=this.polys[n].getGeom();null!==r&&t.push(r)}return t}},{key:"_composePolys",value:function(t){for(var n=[],e=0,r=t.length;e<r;e++){var i=t[e];if(!i.poly)if(i.isExteriorRing())n.push(new L(i));else{var o=i.enclosingRing();o.poly||n.push(new L(o)),o.poly.addInterior(i)}}return n}}]),n}(),B=function(){function n(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j.compare;t(this,n),this.queue=e,this.tree=new h(r),this.segments=[]}return e(n,[{key:"process",value:function(t){var n=t.segment,e=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(n),e;var r=t.isLeft?this.tree.insert(n):this.tree.find(n);if(!r)throw new Error("Unable to find segment #".concat(n.id," ")+"[".concat(n.leftSE.point.x,", ").concat(n.leftSE.point.y,"] -> ")+"[".concat(n.rightSE.point.x,", ").concat(n.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var i=r,o=r,s=void 0,u=void 0;void 0===s;)null===(i=this.tree.prev(i))?s=null:void 0===i.key.consumedBy&&(s=i.key);for(;void 0===u;)null===(o=this.tree.next(o))?u=null:void 0===o.key.consumedBy&&(u=o.key);if(t.isLeft){var l=null;if(s){var h=s.getIntersection(n);if(null!==h&&(n.isAnEndpoint(h)||(l=h),!s.isAnEndpoint(h)))for(var a=this._splitSafely(s,h),f=0,c=a.length;f<c;f++)e.push(a[f])}var p=null;if(u){var g=u.getIntersection(n);if(null!==g&&(n.isAnEndpoint(g)||(p=g),!u.isAnEndpoint(g)))for(var v=this._splitSafely(u,g),y=0,x=v.length;y<x;y++)e.push(v[y])}if(null!==l||null!==p){var d;d=null===l?p:null===p||R.comparePoints(l,p)<=0?l:p,this.queue.remove(n.rightSE),e.push(n.rightSE);for(var b=n.split(d),m=0,E=b.length;m<E;m++)e.push(b[m])}e.length>0?(this.tree.remove(n),e.push(t)):(this.segments.push(n),n.prev=s)}else{if(s&&u){var S=s.getIntersection(u);if(null!==S){if(!s.isAnEndpoint(S))for(var w=this._splitSafely(s,S),_=0,k=w.length;_<k;_++)e.push(w[_]);if(!u.isAnEndpoint(S))for(var P=this._splitSafely(u,S),M=0,I=P.length;M<I;M++)e.push(P[M])}}this.tree.remove(n)}return e}},{key:"_splitSafely",value:function(t,n){this.tree.remove(t);var e=t.rightSE;this.queue.remove(e);var r=t.split(n);return r.push(e),void 0===t.consumedBy&&this.tree.insert(t),r}}]),n}(),T="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,q="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,G=new(function(){function n(){t(this,n)}return e(n,[{key:"run",value:function(t,n,e){G.type=t,m.reset();for(var r=[new N(n,!0)],i=0,o=e.length;i<o;i++)r.push(new N(e[i],!1));if(G.numMultiPolys=r.length,"difference"===G.type)for(var s=r[0],u=1;u<r.length;)null!==g(r[u].bbox,s.bbox)?u++:r.splice(u,1);if("intersection"===G.type)for(var l=0,a=r.length;l<a;l++)for(var f=r[l],c=l+1,p=r.length;c<p;c++)if(null===g(f.bbox,r[c].bbox))return[];for(var v=new h(R.compare),y=0,x=r.length;y<x;y++)for(var d=r[y].getSweepEvents(),b=0,E=d.length;b<E;b++)if(v.insert(d[b]),v.size>T)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var S=new B(v),w=v.size,_=v.pop();_;){var k=_.key;if(v.size===w){var P=k.segment;throw new Error("Unable to pop() ".concat(k.isLeft?"left":"right"," SweepEvent ")+"[".concat(k.point.x,", ").concat(k.point.y,"] from segment #").concat(P.id," ")+"[".concat(P.leftSE.point.x,", ").concat(P.leftSE.point.y,"] -> ")+"[".concat(P.rightSE.point.x,", ").concat(P.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(v.size>T)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(S.segments.length>q)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var M=S.process(k),I=0,j=M.length;I<j;I++){var A=M[I];void 0===A.consumedBy&&v.insert(A)}w=v.size,_=v.pop()}m.reset();var O=z.factory(S.segments);return new F(O).getGeom()}}]),n}());return{union:function(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return G.run("union",t,e)},intersection:function(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return G.run("intersection",t,e)},xor:function(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return G.run("xor",t,e)},difference:function(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return G.run("difference",t,e)}}}()}},n={};function e(r){var i=n[r];if(void 0!==i)return i.exports;var o=n[r]={exports:{}};return t[r].call(o.exports,o,o.exports,e),o.exports}e.d=(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return(()=>{"use strict";e.r(r),e.d(r,{Idw2Contour:()=>_});var t=e(970);function n(t){return Math.ceil(Math.log(function(t,n){let e=0;for(let n of t)null!=n&&(n=+n)>=n&&++e;return e}(t))/Math.LN2)+1}var i=Math.sqrt(50),o=Math.sqrt(10),s=Math.sqrt(2);var u=Array.prototype.slice;function l(t,n){return t-n}const h=t=>()=>t;function a(t,n){for(var e,r=-1,i=n.length;++r<i;)if(e=f(t,n[r]))return e;return 0}function f(t,n){for(var e=n[0],r=n[1],i=-1,o=0,s=t.length,u=s-1;o<s;u=o++){var l=t[o],h=l[0],a=l[1],f=t[u],p=f[0],g=f[1];if(c(l,f,n))return 0;a>r!=g>r&&e<(p-h)*(r-a)/(g-a)+h&&(i=-i)}return i}function c(t,n,e){var r,i,o,s;return function(t,n,e){return(n[0]-t[0])*(e[1]-t[1])==(e[0]-t[0])*(n[1]-t[1])}(t,n,e)&&(i=t[r=+(t[0]===n[0])],o=e[r],s=n[r],i<=o&&o<=s||s<=o&&o<=i)}function p(){}var g=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function v(){var t=1,e=1,r=n,f=x;function c(t){var n,e,u,h,a,f,c=r(t);if(Array.isArray(c))c=c.slice().sort(l);else{const r=function(t,n){let e,r;for(const n of t)null!=n&&(void 0===e?n>=n&&(e=r=n):(e>n&&(e=n),r<n&&(r=n)));return[e,r]}(t),l=(n=r[0],e=r[1],u=c,h=Math.abs(e-n)/Math.max(0,u),a=Math.pow(10,Math.floor(Math.log(h)/Math.LN10)),(f=h/a)>=i?a*=10:f>=o?a*=5:f>=s&&(a*=2),e<n?-a:a);c=function(t,n,e){var r,u,l,h,a=-1;if(e=+e,(t=+t)==(n=+n)&&e>0)return[t];if((r=n<t)&&(u=t,t=n,n=u),0===(h=function(t,n,e){var r=(n-t)/Math.max(0,e),u=Math.floor(Math.log(r)/Math.LN10),l=r/Math.pow(10,u);return u>=0?(l>=i?10:l>=o?5:l>=s?2:1)*Math.pow(10,u):-Math.pow(10,-u)/(l>=i?10:l>=o?5:l>=s?2:1)}(t,n,e))||!isFinite(h))return[];if(h>0){let e=Math.round(t/h),r=Math.round(n/h);for(e*h<t&&++e,r*h>n&&--r,l=new Array(u=r-e+1);++a<u;)l[a]=(e+a)*h}else{h=-h;let e=Math.round(t*h),r=Math.round(n*h);for(e/h<t&&++e,r/h>n&&--r,l=new Array(u=r-e+1);++a<u;)l[a]=(e+a)/h}return r&&l.reverse(),l}(Math.floor(r[0]/l)*l,Math.floor(r[1]/l-1)*l,c)}return c.map((n=>v(t,n)))}function v(n,r){var i=[],o=[];return function(n,r,i){var o,s,u,l,h,a,f=new Array,c=new Array;for(o=s=-1,l=n[0]>=r,g[l<<1].forEach(p);++o<t-1;)u=l,l=n[o+1]>=r,g[u|l<<1].forEach(p);for(g[l<<0].forEach(p);++s<e-1;){for(o=-1,l=n[s*t+t]>=r,h=n[s*t]>=r,g[l<<1|h<<2].forEach(p);++o<t-1;)u=l,l=n[s*t+t+o+1]>=r,a=h,h=n[s*t+o+1]>=r,g[u|l<<1|h<<2|a<<3].forEach(p);g[l|h<<3].forEach(p)}for(o=-1,h=n[s*t]>=r,g[h<<2].forEach(p);++o<t-1;)a=h,h=n[s*t+o+1]>=r,g[h<<2|a<<3].forEach(p);function p(t){var n,e,r=[t[0][0]+o,t[0][1]+s],u=[t[1][0]+o,t[1][1]+s],l=y(r),h=y(u);(n=c[l])?(e=f[h])?(delete c[n.end],delete f[e.start],n===e?(n.ring.push(u),i(n.ring)):f[n.start]=c[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete c[n.end],n.ring.push(u),c[n.end=h]=n):(n=f[h])?(e=c[l])?(delete f[n.start],delete c[e.end],n===e?(n.ring.push(u),i(n.ring)):f[e.start]=c[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete f[n.start],n.ring.unshift(r),f[n.start=l]=n):f[l]=c[h]={start:l,end:h,ring:[r,u]}}g[h<<3].forEach(p)}(n,r,(function(t){f(t,n,r),function(t){for(var n=0,e=t.length,r=t[e-1][1]*t[0][0]-t[e-1][0]*t[0][1];++n<e;)r+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return r}(t)>0?i.push([t]):o.push(t)})),o.forEach((function(t){for(var n,e=0,r=i.length;e<r;++e)if(-1!==a((n=i[e])[0],t))return void n.push(t)})),{type:"MultiPolygon",value:r,coordinates:i}}function y(n){return 2*n[0]+n[1]*(t+1)*4}function x(n,r,i){n.forEach((function(n){var o,s=n[0],u=n[1],l=0|s,h=0|u,a=r[h*t+l];s>0&&s<t&&l===s&&(o=r[h*t+l-1],n[0]=s+(i-o)/(a-o)-.5),u>0&&u<e&&h===u&&(o=r[(h-1)*t+l],n[1]=u+(i-o)/(a-o)-.5)}))}return c.contour=v,c.size=function(n){if(!arguments.length)return[t,e];var r=Math.floor(n[0]),i=Math.floor(n[1]);if(!(r>=0&&i>=0))throw new Error("invalid size");return t=r,e=i,c},c.thresholds=function(t){return arguments.length?(r="function"==typeof t?t:Array.isArray(t)?h(u.call(t)):h(t),c):r},c.smooth=function(t){return arguments.length?(f=t?x:p,c):f===x},c}function y(t,n,e){void 0===e&&(e={});var r={type:"Feature"};return(0===e.id||e.id)&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.properties=n||{},r.geometry=t,r}function x(t,n,e){void 0===e&&(e={});for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return y({type:"Polygon",coordinates:t},n,e)}function d(t,n,e){return void 0===e&&(e={}),y({type:"MultiPolygon",coordinates:t},n,e)}function b(t){return"Feature"===t.type?t.geometry:t}var m=e(676);function E(t,n){return t.map((function(t){return t.map((function(t){return[n.xlim[0]+t[0]*n.x_resolution,n.y_resolution<0?n.ylim[1]+t[1]*n.y_resolution:n.ylim[0]+t[1]*n.y_resolution]}))}))}var S=function(t,n,e){var r=function(t,n){for(var e=v().size([t.n,t.m]).thresholds(n)(t.grid),r={type:"FeatureCollection",features:[]},i=function(n){var i=e[n];if("MultiPolygon"===i.type)i.coordinates.forEach((function(n){var e={type:"Polygon",coordinates:[]};e.coordinates=E(n,t),e.coordinates.length>0&&r.features.push({type:"Feature",properties:{value:i.value},geometry:e})}));else if("Polygon"===i.type){var o={type:"Polygon",coordinates:[]};o.coordinates=E(i.coordinates,t),o.coordinates.length>0&&r.features.push({type:"Feature",properties:{value:i.value},geometry:o})}},o=0;o<e.length;o++)i(o);return r}(t,n);if(e){var i=[];r.features.forEach((function(t){var n=function(t,n,e){void 0===e&&(e={});var r=b(t),i=b(n),o=m.intersection(r.coordinates,i.coordinates);return 0===o.length?null:1===o.length?x(o[0],e.properties):d(o,e.properties)}(t,e);n&&(n.properties=t.properties,i.push(n))})),r.features=i}return r};function w(t,n){var e=t.lat,r=t.lon,i=n.lat-0,o=n.lon-0,s=Math.PI/180,u=(i-e)*s,l=(o-r)*s,h=e*s,a=i*s,f=Math.sin(u/2),c=Math.sin(l/2),p=f*f+c*c*Math.cos(h)*Math.cos(a);return Math.atan2(Math.sqrt(p),Math.sqrt(1-p))}var _=function(n){var e=n.points,r=n.breaks,i=n.clpFeature,o=n.valueField,s=void 0===o?"tempvalue":o,u=n.gridOptions,l=function(n,e,r){var i=function(t){for(var n=t.xStart,e=t.xSize,r=t.xDelta,i=t.yStart,o=t.ySize,s=t.yDelta,u=[],l=[],h=0;h<e;h++)u.push(n+h*r);for(var a=0;a<o;a++)l.push(i+a*s);return{XLon:u,Ylat:l}}(e),o=function(n,e,r){for(var i=[],o=e.XLon,s=e.Ylat,u=[o.length,s.length],l=u[0],h=u[1],a=new t.kdTree(n,w,["lon","lat"]),f=0;f<h;f++){i[f]=[];for(var c=0;c<l;c++){for(var p={lon:o[c],lat:s[f]},g=a.nearest(p,2),v=0,y=0,x=g.length,d=0;d<x;d++){var b=g[d][0],m=w(p,b),E=Number(b[r]);if(999999!=E){if(Math.abs(m)<1e-4){v=E,y=1;break}v+=E/Math.pow(m,2),y+=1/Math.pow(m,2)}}Math.abs(y)<1e-4?i[f][c]=999999:i[f][c]=v/y}}return i}(n,i,r);return{m:e.ySize,n:e.xSize,x_resolution:e.xDelta,y_resolution:e.yDelta,xlim:[e.xStart,e.xEnd],ylim:[e.yStart,e.yEnd],zlim:[],grid:o.reduce((function(t,n){return t.concat(n)}))}}(e,void 0===u?{xStart:105.24,xEnd:110.24,yStart:28.15,yEnd:32.5,xDelta:.05,yDelta:.05,xSize:101,ySize:88}:u,s);return{gridData:l,vector_contours:S(l,r,i)}}})(),r})()}));